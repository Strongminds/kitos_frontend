<app-scrollbar-dialog [title]="title" backgroundColor="grey">
  <form [formGroup]="fkOrgFormGroup">
    <app-standard-vertical-content-grid>
      <ng-container *ngIf="(isLoading$ | async) !== true">
        <app-card class="configuration-margin-bottom">
          <app-card-header
            title="Konfiguration"
            helpTextKey="local-config-fk-org-import-modal.configuration"
          ></app-card-header>
          <app-standard-vertical-content-grid>
            <div>
              <app-numeric-input
                text="Niveauer"
                class="levels-margin-bottom"
                i18n-text
                [formGroup]="fkOrgFormGroup"
                formName="levels"
                [minLength]="1"
                (valueChange)="levelChange($event)"
              ></app-numeric-input>
              <app-paragraph paragraphSize="x-small" [dimmed]="true" i18n
                >KITOS synkroniserer 2 niveauer fra organisationshierarkiet i FK Organisation. Slet indtastningen for at
                synkronisere det fulde organisationshierarki.
              </app-paragraph>
            </div>
            <div>
              <app-checkbox
                text="Tjek automatisk efter ventende opdateringer*"
                i18n-text
                labelPosition="after"
                [formGroup]="fkOrgFormGroup"
                formName="subscribeToUpdates"
              ></app-checkbox>
              <app-paragraph paragraphSize="x-small" [dimmed]="true" i18n
                >* Foretager automatisk tjek hver mandag nat og sender en email med oversigt over ventende opdateringer
                til brugere i kommunen med rollen "Lokal Administrator"</app-paragraph
              >
            </div>
          </app-standard-vertical-content-grid>
        </app-card>
        <app-card>
          <app-card-header
            title="Forhåndsvisning"
            i18n-title
            helpTextKey="local-config-fk-org-import-modal.units"
          ></app-card-header>
          <app-drag-and-drop-tree
            *ngIf="snapshot$ | async as snapshot"
            itemType="organization"
            [currentNodeUuid]="snapshot.uuid"
            [nodes]="(snapshotTree$ | async) ?? []"
            [disableDrag]="true"
            (nodeExpandClick)="nodeExpandClick($event)"
            [maxLevel]="(levelsSubject$ | async) ?? undefined"
          ></app-drag-and-drop-tree>
        </app-card>
      </ng-container>
      <app-loading *ngIf="isLoading$ | async"></app-loading>
    </app-standard-vertical-content-grid>
  </form>
  <app-dialog-actions>
    <app-button (buttonClick)="synchronize()" [disabled]="(isLoading$ | async) ?? false" i18n
      >Gennemfør synkronisering</app-button
    >
    <app-button color="warn" (buttonClick)="cancel()" [disabled]="(isLoading$ | async) ?? false" i18n
      >Annuler</app-button
    >
  </app-dialog-actions>
</app-scrollbar-dialog>
