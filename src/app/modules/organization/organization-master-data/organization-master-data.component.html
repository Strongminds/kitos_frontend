<ng-content *ngIf="organizationName$ | async as organizationName">
  <h4 i18n class="title-margin" data-cy="master-data-headline">Stamdata for {{ organizationName }}</h4>
<app-card class="card-top-margin">
  <app-card-header [title]="organizationName"></app-card-header>
  <app-form-grid>
    <app-numeric-input
      i18n-text
      text="CVR-nummer"
      [formGroup]="masterDataForm"
      formName="cvrControl"
      (valueChange)="patchMasterData({ cvr: $event?.toString() })"
      data-cy='master-data-cvr-input'
      [disabled]="(hasOrganizationCvrModifyPermission$ | async) === false"
    ></app-numeric-input>
    <app-textbox
      i18n-text
      text="Telefonnummer"
      [formGroup]="masterDataForm"
      formName="phoneControl"
      (valueChange)="patchMasterData({ phone: $event })"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Email"
      [formGroup]="masterDataForm"
      formName="emailControl"
      (valueChange)="patchMasterData({ email: $event })"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Adresse"
      [formGroup]="masterDataForm"
      formName="addressControl"
      (valueChange)="patchMasterData({ address: $event })"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
  </app-form-grid>
</app-card>
</ng-content>

<app-card>
  <app-card-header i18n-title title="Dataansvarlig"></app-card-header>
  <app-form-grid>
    <app-textbox
      i18n-text
      text="Fornavn"
      [formGroup]="dataResponsibleForm"
      formName="nameControl"
      (valueChange)="patchMasterDataRolesDataResponsible()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-numeric-input
      i18n-text
      text="CVR-nummer"
      [formGroup]="dataResponsibleForm"
      formName="cvrControl"
      (valueChange)="patchMasterDataRolesDataResponsible()"
      data-cy="data-responsible-cvr-input"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-numeric-input>
    <app-textbox
      i18n-text
      text="Telefonnummer"
      [formGroup]="dataResponsibleForm"
      formName="phoneControl"
      (valueChange)="patchMasterDataRolesDataResponsible()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Email"
      [formGroup]="dataResponsibleForm"
      formName="emailControl"
      (valueChange)="patchMasterDataRolesDataResponsible()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Adresse"
      [formGroup]="dataResponsibleForm"
      formName="addressControl"
      (valueChange)="patchMasterDataRolesDataResponsible()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
  </app-form-grid>
</app-card>

<app-card>
  <app-card-header i18n-title title="Databeskyttelsesrådgiver"></app-card-header>
  <app-form-grid>
    <app-textbox
      i18n-text
      text="Fornavn"
      [formGroup]="dataProtectionAdvisorForm"
      formName="nameControl"
      (valueChange)="patchMasterDataRolesDataProtectionAdvisor()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-numeric-input
      i18n-text
      text="CVR-nummer"
      [formGroup]="dataProtectionAdvisorForm"
      formName="cvrControl"
      (valueChange)="patchMasterDataRolesDataProtectionAdvisor()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-numeric-input>
    <app-textbox
      i18n-text
      text="Telefonnummer"
      [formGroup]="dataProtectionAdvisorForm"
      formName="phoneControl"
      (valueChange)="patchMasterDataRolesDataProtectionAdvisor()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Email"
      [formGroup]="dataProtectionAdvisorForm"
      formName="emailControl"
      (valueChange)="patchMasterDataRolesDataProtectionAdvisor()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Adresse"
      [formGroup]="dataProtectionAdvisorForm"
      formName="addressControl"
      (valueChange)="patchMasterDataRolesDataProtectionAdvisor()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
  </app-form-grid>
</app-card>

<app-card>
  <app-card-header i18n-title title="Kontaktperson"></app-card-header>
  <app-form-grid>
    <app-textbox
      i18n-text
      text="Fornavn"
      [formGroup]="contactPersonForm"
      formName="nameControl"
      (valueChange)="patchMasterDataRolesContactPerson()"
      data-cy="contact-person-name-control"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Efternavn"
      [formGroup]="contactPersonForm"
      formName="lastNameControl"
      (valueChange)="patchMasterDataRolesContactPerson()"
      data-cy="contact-person-last-name-control"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
      i18n-text
      text="Telefonnummer"
      [formGroup]="contactPersonForm"
      formName="phoneControl"
      (valueChange)="patchMasterDataRolesContactPerson()"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-textbox>
    <app-textbox
    i18n-text
    text="Email (fritekst)"
    [formGroup]="contactPersonForm"
    formName="emailControl"
    (valueChange)="updateMasterDataRolesContactPersonEmailFreeText()"
    data-cy="contact-person-phone-control"
    [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    >
  </app-textbox>
    <app-connected-dropdown
      i18n-text
      text="Email (fremsøg eksisterende bruger)"
      [formGroup]="contactPersonForm"
      formName="emailControlDropdown"
      valueField="uuid"
      [data$]="organizationUserIdentityNamePairs$"
      [isLoading$]="organizationUsersLoading$"
      (filterChange)="searchOrganizationUsers($event)"
      (valueChange)="selectContactPersonFromOrganizationUsers($event)"
      data-cy="contact-person-email-dropdown"
      [disabled]="(hasOrganizationModifyPermission$ | async) === false"
    ></app-connected-dropdown>
  </app-form-grid>
</app-card>
