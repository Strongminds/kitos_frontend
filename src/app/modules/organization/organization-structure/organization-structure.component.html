<h4>Organisation</h4>
<div class="structure-page-flex">
  <app-card class="structure-section-width">
    <div class="card-header">
      <h6 i18n>Organisationslag</h6>
      <app-menu-button iconType="dots" buttonStyle="tertiary" class="align-end">
        <app-menu-button-item i18n (itemClick)="openCreateSubUnitDialog()"
          ><app-plus-icon-blue></app-plus-icon-blue> Opret ny enhed</app-menu-button-item
        >
        <app-menu-button-item i18n (itemClick)="changeDragState()"
          ><app-reorder-icon></app-reorder-icon> Omstrukturer</app-menu-button-item
        >
      </app-menu-button>
    </div>
    <app-drag-and-drop-tree
      *ngIf="currentUnitUuid$ | async as currentUnitUuid"
      itemType="organization"
      [currentNodeUuid]="currentUnitUuid"
      [nodes]="(unitTree$ | async) ?? []"
      [disableDrag]="(isDragDisabled$ | async) ?? true"
      (nodeMoved)="moveNode($event)"
      (nodeExpandClick)="nodeExpandClick($event)"
    ></app-drag-and-drop-tree>
    <ng-container *ngIf="(hasFkOrg$ | async) === true">
      <app-paragraph paragraphSize="x-small" [dimmed]="true" i18n
        ><app-kitos-unit-color-icon></app-kitos-unit-color-icon> Enheder oprettet i Kitos</app-paragraph
      >
      <app-paragraph paragraphSize="x-small" [dimmed]="true" i18n
        ><app-fk-org-color-icon></app-fk-org-color-icon> Enheder synkroniseret fra FK Organisation</app-paragraph
      >
    </ng-container>
    <app-loading *ngIf="(currentUnitUuid$ | async) === undefined"></app-loading>
  </app-card>
  <div class="flex-roles-section">
    <app-card>
      <app-details-header [title$]="currentUnitName$" i18n-title>
        <app-menu-button iconType="dots" buttonStyle="tertiary" i18n-title data-cy="more-button">
          <app-menu-button-item
            i18n
            (itemClick)="openDeleteDialog()"
            [disabled]="(isRootUnitSelected$ | async) || false"
            data-cy="delete-button"
            >Slet enhed</app-menu-button-item
          >
        </app-menu-button>
        <app-button buttonStyle="secondary">
          <app-checkbox i18n> </app-checkbox>
          <!-- TODO: needs refinement -->
          TilfÃ¸j brugere fra underenheder
        </app-button>

        <app-button buttonStyle="secondary" i18n (buttonClick)="onClickEdit()" data-cy="edit-button"
          >Rediger enhed</app-button
        >
        <app-button buttonStyle="primary" i18n>Opret rolle</app-button>
      </app-details-header>


      <app-organization-unit-role-table [currentUnitUuid$]="currentUnitUuid$" [currentUnitName$]="currentUnitName$"></app-organization-unit-role-table>
    </app-card>
  </div>
</div>
