<ng-container *ngIf="unit$ | async as unit">
  <app-dialog [title]="'Rediger ' + unit.name" i18n-title backgroundColor="grey" [noPadding]="true">
    <div class="content">
      <div class="grid-container">
        <app-standard-vertical-content-grid class="basic-information-section">
          <app-paragraph paragraphSize="large" [bold]="true" i18n>Information om enhed</app-paragraph>
          <div>
            <app-dropdown
              [text]="(getParentUnitDropdownText() | async) ?? ''"
              i18n-text
              [value]="unit.parentOrganizationUnit ?? unit.name"
              [data]="validParentOrganizationUnits$ | async"
              [formGroup]="baseInfoForm"
              formName="parentUnitControl"
            ></app-dropdown>
            <app-textbox-info i18n>{{ getParentUnitHelpText() | async }}</app-textbox-info>
          </div>

          <app-textbox
            [value]="unit.name"
            text="Enhedens navn"
            i18n-text
            [formGroup]="baseInfoForm"
            formName="nameControl"
            data-cy="name-control"
          ></app-textbox>

          <app-numeric-input
            [value]="unit.ean"
            text="EAN nummer"
            i18n-text
            [formGroup]="baseInfoForm"
            formName="eanControl"
            data-cy="ean-control"
          ></app-numeric-input>

          <app-textbox
            [value]="unit.unitId"
            text="Enhedens ID"
            i18n-tex
            [formGroup]="baseInfoForm"
            formName="idControl"
          ></app-textbox>
          <app-dialog-actions>
            <app-button [color]="confirmColor" size="large" (buttonClick)="onSave()" i18n data-cy="save-button"
              >Gem</app-button
            >
          </app-dialog-actions>
        </app-standard-vertical-content-grid>
        <div class="registrations-section-container">
          <app-standard-vertical-content-grid class="registrations-section">
            <app-paragraph paragraphSize="large" [bold]="true" i18n>Registeringer for: {{ unit.name }}</app-paragraph>
            <!-- Check if it's loading -->
            <ng-container *ngIf="(isLoading$ | async) === false">
              <!-- Check for empty state -->
              <ng-container *ngIf="anyRegistrations$ | async">
                <app-org-unit-select
                  text="Overfør til"
                  i18n-text
                  [disabledUnitsUuids]="[unit.uuid]"
                ></app-org-unit-select>

                <app-registrations-roles-section
                  *ngIf="hasOrganizationUnitRights$ | async"
                  [unitUuid]="unit.uuid"
                  registrationType="unitRights"
                ></app-registrations-roles-section>
                <app-accordion
                  *ngIf="hasInternalPayments$ | async"
                  title="Interne betalinger"
                  i18n-title
                ></app-accordion>
                <app-accordion
                  *ngIf="hasExternalPayments$ | async"
                  title="Eksterne betalinger"
                  i18n-title
                ></app-accordion>
                <app-accordion
                  *ngIf="hasItContractRegistrations$ | async"
                  title="Kontrakter (ansvarlig organisationsenhed)"
                  i18n-title
                ></app-accordion>
                <app-accordion
                  *ngIf="hasRelevantSystems$ | async"
                  title="System (relevant organisationsenhed)"
                  i18n-title
                ></app-accordion>
                <app-accordion
                  *ngIf="hasResponsibleSystems$ | async"
                  title="System (ansvarlig organisationsenhed)"
                  i18n-title
                ></app-accordion>
              </ng-container>

              <!-- Display empty state -->
              <ng-container *ngIf="(anyRegistrations$ | async) === false"> EMPTY STATE </ng-container>
            </ng-container>

            <!-- Loading state -->
            <app-loading *ngIf="(isLoading$ | async) !== false"></app-loading>
          </app-standard-vertical-content-grid>
          <!-- Snackbar -->
          <div class="snackbar">
            <app-paragraph color="white" paragraphSize="medium" [dimmed]="true" i18n
              >Vælg handling for valgte registreringer</app-paragraph
            >

            <div class="right-buttons">
              <app-button color="secondary" buttonStyle="secondary" size="small" i18n>Slet</app-button>
              <app-button color="secondary" size="small" i18n>Overfør</app-button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="dialog-footer">
      <app-button i18n buttonStyle="tertiary" color="warn" data-cy="delete-unit-button"
        ><app-trashcan-icon></app-trashcan-icon> Slet enhed</app-button
      >
      <div class="right-buttons">
        <app-button
          buttonStyle="secondary"
          [color]="'accent'"
          i18n
          data-cy="deselect-all-button"
          [disabled]="!isAllSelected"
          (buttonClick)="changeSelectAllRegistrationsState()"
          >Fravælg alle</app-button
        >
        <app-button
          i18n
          buttonStyle="secondary"
          color="accent"
          data-cy="select-all-button"
          [disabled]="isAllSelected"
          (buttonClick)="changeSelectAllRegistrationsState()"
          >Vælg alle</app-button
        >
      </div>
    </div>
  </app-dialog>
</ng-container>
