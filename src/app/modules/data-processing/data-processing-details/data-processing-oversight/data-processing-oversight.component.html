@if (intervalCardEnabled$ | async) {
<app-card>
  <app-card-header
    title="Interval"
    i18n-title
    helpTextKey="data-processing.edit-registration.oversight"
  ></app-card-header>
  <form [formGroup]="generalInformationForm">
    <app-standard-vertical-content-grid>
      @if (oversightIntervalEnabled$ | async) {
      <app-dropdown
        text="Tilsynsinterval"
        [formGroup]="generalInformationForm"
        formName="interval"
        data-cy="data-processing-oversight-interval"
        [data]="oversightIntervalOptions"
        i18n-text
        (valueChange)="patchOversight({ oversightInterval: $event })"
      ></app-dropdown>
      <app-textarea
        text="Bemærkninger til interval"
        [formGroup]="generalInformationForm"
        formName="intervalRemarks"
        data-cy="data-processing-oversight-interval.remarks"
        i18n-text
        (valueChange)="patchOversight({ oversightIntervalRemark: $event })"
      ></app-textarea>
      } @if (nextOversightEnabled$ | async) {
      <app-datepicker
        text="Kommende planlagt tilsyn"
        [formGroup]="generalInformationForm"
        formName="completedAt"
        (valueChange)="patchOversight({ oversightScheduledInspectionDate: $event?.toDateString() })"
        data-cy="data-processing-oversight-next-oversight"
        i18n-text
      ></app-datepicker>
      } @if (oversightOptionsEnabled$ | async) {
      <app-textarea
        text="Bemærkninger til valgte tilsynsmuligheder"
        [formGroup]="generalInformationForm"
        formName="remarks"
        data-cy="data-processing-oversight-remarks"
        (valueChange)="patchOversight({ oversightOptionsRemark: $event })"
        i18n-text
      ></app-textarea>
      }
    </app-standard-vertical-content-grid>
  </form>
</app-card>
} @if (oversightOptionsEnabled$ | async) {
<app-card>
  <app-card-header
    title="Tilsynsmuligheder"
    i18n-title
    helpTextKey="data-processing.edit-oversight.options"
  ></app-card-header>
  <app-standard-vertical-content-grid>
    @if (anyOversightOptions$ | async) {
    <app-native-table>
      <thead>
        <th i18n>Tilsyn</th>
      </thead>
      <tbody>
        @for (oversightOption of oversightOptions$ | async; track oversightOption) {
        <tr>
          <td>
            <app-content-space-between>
              <app-paragraph paragraphSize="small">{{ oversightOption.name }}</app-paragraph>
              @if ((hasModifyPermission$ | async) === true) {
              <app-icon-button
                (buttonClick)="onDeleteOversight(oversightOption.uuid)"
                data-cy="delete-agreement-element-button"
                ><app-trashcan-icon></app-trashcan-icon
              ></app-icon-button>
              }
            </app-content-space-between>
          </td>
        </tr>
        }
      </tbody>
    </app-native-table>
    } @if ((anyOversightOptions$ | async) === false) {
    <app-empty-state text="Ingen tilsynsmuligheder tilføjet endnu" context="emptyTable" i18n-text> </app-empty-state>
    }

    <app-collection-extension-button
      text="Tilføj mulighed"
      i18n-text
      data-cy="oversight-create-button"
      [disabled]="(hasModifyPermission$ | async) !== true"
      (clicked)="onAddNewOversight()"
    >
    </app-collection-extension-button>
  </app-standard-vertical-content-grid>
</app-card>
} @if (oversightsEnabled$ | async) {
<app-card>
  <app-card-header
    title="Gennemførte og kommende tilsyn"
    i18n-title
    helpTextKey="data-processing.edit-oversight.oversights"
  >
  </app-card-header>
  <app-standard-vertical-content-grid>
    <app-oversights-table></app-oversights-table>
  </app-standard-vertical-content-grid>
</app-card>
}
