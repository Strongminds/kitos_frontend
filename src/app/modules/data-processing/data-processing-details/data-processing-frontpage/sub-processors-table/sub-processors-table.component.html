<app-standard-vertical-content-grid data-cy="subprocessors-table">
  @if (anySubProcessors$ | async) {
    <app-native-table>
      <thead>
        <th i18n>Navn</th>
        <th i18n>CVR</th>
        <th i18n>Overførselsgrundlag</th>
        <th i18n>Overførsel til usikkert 3. land</th>
        <th i18n>Land der overføres til</th>
      </thead>
      <tbody>
        @for (subprocessor of subprocessors$ | async; track subprocessor) {
          <tr>
            <td>
              <app-paragraph paragraphSize="medium">{{ subprocessor.dataProcessorOrganization.name }}</app-paragraph>
            </td>
            <td>
              <app-paragraph paragraphSize="medium">{{ subprocessor.dataProcessorOrganization.cvr }}</app-paragraph>
            </td>
            <td>
              <app-paragraph paragraphSize="medium">{{ subprocessor.basisForTransfer?.name }}</app-paragraph>
            </td>
            <td>
              @if (
                subprocessor.transferToInsecureThirdCountry && subprocessor.transferToInsecureThirdCountry !== 'Undecided'
                ) {
                <app-paragraph
                  paragraphSize="medium"
                  ><app-boolean-circle [value]="subprocessor.transferToInsecureThirdCountry === 'Yes'"></app-boolean-circle
                ></app-paragraph>
              }
            </td>
            <td>
              <app-content-space-between>
                <app-paragraph paragraphSize="medium">{{
                  subprocessor.insecureThirdCountrySubjectToDataProcessing?.name
                }}</app-paragraph>
                @if ((hasModifyPermissions$ | async) === true) {
                  <app-table-row-actions>
                    <app-icon-button (buttonClick)="onEdit(subprocessor)" data-cy="edit-payment-button"
                      ><app-pencil-icon></app-pencil-icon
                    ></app-icon-button>
                    <app-icon-button
                      (buttonClick)="onDeleteProcessor(subprocessor.dataProcessorOrganization.uuid)"
                      data-cy="delete-subprocessor-button"
                      ><app-trashcan-icon></app-trashcan-icon
                    ></app-icon-button>
                  </app-table-row-actions>
                }
              </app-content-space-between>
            </td>
          </tr>
        }
      </tbody>
    </app-native-table>
  }
  @if ((anySubProcessors$ | async) === false) {
    <app-empty-state
      text="Ingen underdatabehandlere tilføjet endnu"
      context="emptyTable"
      i18n-text
    ></app-empty-state>
  }
  @if ((hasModifyPermissions$ | async) === true) {
    <app-collection-extension-button
      (clicked)="onAddNewSubProcessor()"
      text="Tilføj underdatabehandler"
      data-cy="add-subprocessor-button"
      i18n-text
    ></app-collection-extension-button>
  }
</app-standard-vertical-content-grid>
