<app-card>
  <app-card-header title="IT kontrakt information" i18n-title helpTextKey="it-contract.edit.main">
    <!--TODO: Requires api changes to include validAccordingTo fields
      <app-status-chip
    type="it-contract"
    [value]="itSystemUsageValid$ | async"
    [title]="invalidReason$ | async"
  ></app-status-chip> -->
  </app-card-header>

  <app-form-grid [formGroup]="frontpageFormGroup">
    <app-textbox
      text="IT kontraktnavn"
      i18n-text
      data-cy="contract-name"
      [formGroup]="frontpageFormGroup"
      formName="name"
      (valueChange)="patchName($event)"
    ></app-textbox>
    <app-textbox
      text="Kontrakt ID"
      i18n-text
      data-cy="contract-id"
      [formGroup]="frontpageFormGroup"
      formName="contractId"
      (valueChange)="patchFrontPage({ general: { contractId: $event } })"
    ></app-textbox>
    <app-dropdown
      text="Kontrakttype"
      i18n-text
      data-cy="contract-type"
      valueField="uuid"
      [formGroup]="frontpageFormGroup"
      formName="contractType"
      [data]="contractTypes$ | async"
      (valueChange)="patchFrontPage({ general: { contractTypeUuid: $event } })"
    >
    </app-dropdown>
    <app-dropdown
      text="Kontraktskabelon"
      i18n-text
      data-cy="contract-template"
      valueField="uuid"
      [formGroup]="frontpageFormGroup"
      formName="contractTemplate"
      [data]="contractTemplates$ | async"
      (valueChange)="patchFrontPage({ general: { contractTemplateUuid: $event } })"
    >
    </app-dropdown>
    <app-dropdown
      text="Kritikalitet"
      i18n-text
      data-cy="contract-criticality"
      [formGroup]="frontpageFormGroup"
      formName="criticality"
      valueField="uuid"
      [data]="criticalityTypes$ | async"
      (valueChange)="patchFrontPage({ general: { criticalityUuid: $event } })"
    ></app-dropdown>
    <app-dropdown
      text="Indkøbsform"
      i18n-text
      data-cy="contract-purchase-type"
      [formGroup]="frontpageFormGroup"
      formName="purchaseType"
      valueField="uuid"
      [data]="purchaseFormTypes$ | async"
      (valueChange)="patchFrontPage({ procurement: { purchaseTypeUuid: $event } })"
    >
    </app-dropdown>
    <app-standard-vertical-content-grid>
      <app-textbox
        text="Status"
        i18n-text
        data-cy="contract-valid-status"
        [formGroup]="frontpageFormGroup"
        formName="status"
      ></app-textbox>
      <app-checkbox
        text="Gennemtving gyldighed"
        i18n-text
        labelPosition="after"
        data-cy="contract-force-validity"
        [formGroup]="frontpageFormGroup"
        formName="enforcedValid"
        (valueChange)="patchFrontPage({ general: { validity: { enforcedValid: $event } } })"
      ></app-checkbox>
    </app-standard-vertical-content-grid>
    <app-datepicker
      text="Gyldig fra"
      i18n-text
      data-cy="contract-valid-from"
      [formGroup]="frontpageFormGroup"
      formName="validFrom"
      (valueChange)="patchFrontPage({ general: { validity: { validFrom: $event?.toISOString() } } })"
    ></app-datepicker>
    <app-datepicker
      text="Gyldig til"
      i18n-text
      data-cy="contract-valid-to"
      [formGroup]="frontpageFormGroup"
      formName="validTo"
      (valueChange)="patchFrontPage({ general: { validity: { validTo: $event?.toISOString() } } })"
    >
    </app-datepicker>

    <app-textarea
      text="Bemærkning"
      class="notes"
      i18n-text
      data-cy="contract-notes"
      [formGroup]="frontpageFormGroup"
      formName="notes"
      (valueChange)="patchFrontPage({ general: { notes: $event } })"
    ></app-textarea>
  </app-form-grid>
</app-card>
